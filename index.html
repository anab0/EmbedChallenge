<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>EmbedSite</title>
    <link rel="stylesheet" href="index.css">
</head>
<body onload="loadElements(0,my_JSON_object.length/2)">
<div id="app">

</div>

<button id="loadButton" onclick="loadSecondHalf()">LOAD MORE</button>


<script>
    let request = new XMLHttpRequest();
    request.open("GET", "./data.json", false);
    request.send(null)
    let my_JSON_object = JSON.parse(request.responseText);

    function loadSecondHalf() {
        loadElements(my_JSON_object.length/2, my_JSON_object.length);
        document.getElementById("loadButton").style.display = "none";
    }

    function loadElements(start, end) {
        let i;
        for(i = start; i<end;i++) {
            let column = document.createElement("div");
            column.setAttribute("class", "column");

            let element = document.createElement("div");
            element.setAttribute("id", "element" + i);
            element.setAttribute("class", "item");

            let header = document.createElement("div");
            header.setAttribute("class", "header");

            let profileImage = document.createElement("img");
            profileImage.setAttribute("src", my_JSON_object[i].profile_image);
            profileImage.setAttribute("class", "profilePic");
            header.appendChild(profileImage);


            let name = document.createElement("span");
            name.innerHTML = my_JSON_object[i].name;
            name.setAttribute("class", "fullName");
            header.appendChild(name);

            let socialImg = document.createElement("img");
            if(my_JSON_object[i].source_type === "facebook") {
                socialImg.setAttribute("src", "./icons/facebook.svg");
            }
            else if(my_JSON_object[i].source_type === "instagram") {
                socialImg.setAttribute("src", "./icons/instagram-logo.svg");
            }
            socialImg.setAttribute("class", "socialPic");
            header.appendChild(socialImg);

            let date = document.createElement("span");
            date.innerHTML = formatDate(my_JSON_object[i].date);
            header.appendChild(date);
            date.setAttribute("class", "date");

            let body = document.createElement("div");

            let bodyImage = document.createElement("img");
            bodyImage.setAttribute("src", my_JSON_object[i].image);
            bodyImage.setAttribute("class", "bodyImage");
            body.appendChild(bodyImage);

            let text = document.createElement("div");
            text.setAttribute("class", "containerText");
            text.innerHTML = my_JSON_object[i].caption.substring(0,100);

            let hr = document.createElement("hr");

            let footer = document.createElement("div");
            footer.setAttribute("class", "footer");

            let heart = document.createElement("img");
            heart.setAttribute("src", "./icons/heart.svg");
            heart.setAttribute("class", "heartImg");
            footer.appendChild(heart);
            let likes = document.createElement("span");
            likes.innerHTML = my_JSON_object[i].likes;
            footer.appendChild(likes);

            element.appendChild(header);
            element.appendChild(body);
            element.appendChild(text);
            element.appendChild(hr);
            element.appendChild(footer);
            column.appendChild(element);

            document.getElementById("app").appendChild(column);
        }
    }

    function formatDate(date) {
        let splited = date.split(" ")[0];
        let splitedDate = splited.split("-");
        let year = splitedDate[0];
        let month = splitedDate[1];
        switch (month) {
            case "01":
                month = "Jan";
                break;
            case "02":
                month = "Feb";
                break;
            case "03":
                month = "Mar";
                break;
            case "04":
                month = "Apr";
                break;
            case "05":
                month = "May";
                break;
            case "06":
                month = "Jun";
                break;
            case "07":
                month = "Jul";
                break;
            case "08":
                month = "Aug";
                break;
            case "09":
                month = "Sep";
                break;
            case "10":
                month = "Oct";
                break;
            case "11":
                month = "Nov";
                break;
            case "12":
                month = "Dec";
                break;
        }
        let day = splitedDate[2];

        return day + " " + month  + " " + year;
    }

</script>
</body>
</html>